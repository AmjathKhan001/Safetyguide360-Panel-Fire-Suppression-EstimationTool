<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fire Suppression System Calculator - WebTools Daily</title>
    <meta name="description" content="Free professional fire suppression system calculator for electrical panels. Calculate costs, gas requirements, and generate quotations instantly.">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üî•</text></svg>">
    
    <!-- AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6687860250561653" crossorigin="anonymous"></script>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VB6549D0LW"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-VB6549D0LW');
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            padding-bottom: 20px;
        }

        .main-title {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 30px;
            text-align: center;
            font-size: 2.2em;
        }

        .centered-subtitle {
            text-align: center;
            color: white;
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            padding: 15px 20px;
            font-size: 1.3em;
            font-weight: 600;
            margin-top: -5px;
            border-bottom: 3px solid #fff;
        }

        .calculator {
            padding: 30px;
        }

        /* Navigation */
        .site-nav {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
        }

        .brand-icon {
            color: #667eea;
            font-size: 24px;
        }

        .brand-text {
            font-weight: bold;
            color: #333;
            font-size: 1.2em;
        }

        .nav-links {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .nav-link {
            color: #555;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }

        .nav-link:hover {
            color: #667eea;
        }

        .nav-link.active {
            color: #ee5a24;
            font-weight: 600;
        }

        .support-nav-btn {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .support-nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(238, 90, 36, 0.3);
        }

        .monetization-section {
            background: #fff9e6;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #ffc107;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .monetization-text {
            flex: 1;
            min-width: 200px;
        }

        .monetization-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .support-btn {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            text-decoration: none;
            display: inline-block;
            text-align: center;
            transition: transform 0.2s;
        }

        .support-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .amazon-btn {
            background: linear-gradient(135deg, #ff9900, #ff6600);
        }

        .coffee-btn {
            background: linear-gradient(135deg, #6f4e37, #8b6b4d);
        }

        .ad-container {
            margin: 20px 0;
            text-align: center;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border: 1px dashed #ddd;
        }

        .visual-guide-section {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #1976d2;
        }

        .visual-guide-section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.4em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .dimension-guide {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            align-items: start;
        }

        .panel-diagram {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            text-align: center;
        }

        .diagram-container {
            position: relative;
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .panel-visual {
            width: 100%;
            height: 250px;
            background: linear-gradient(135deg, #e0e0e0, #f5f5f5);
            border: 3px solid #333;
            position: relative;
            margin: 0 auto;
            border-radius: 5px;
        }

        .compartment {
            position: absolute;
            background: rgba(255, 87, 34, 0.1);
            border: 2px dashed #ff5722;
            border-radius: 3px;
        }

        .compartment-1 {
            top: 20px;
            left: 20px;
            width: 120px;
            height: 80px;
        }

        .compartment-2 {
            top: 20px;
            right: 20px;
            width: 100px;
            height: 100px;
        }

        .compartment-3 {
            bottom: 20px;
            left: 20px;
            width: 150px;
            height: 60px;
        }

        .dimension-line {
            position: absolute;
            background: #1976d2;
        }

        .dimension-text {
            position: absolute;
            background: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
            color: #1976d2;
            border: 1px solid #1976d2;
        }

        .horizontal-line {
            height: 2px;
            width: 100px;
        }

        .vertical-line {
            width: 2px;
            height: 80px;
        }

        .dimension-arrow {
            position: absolute;
            width: 0;
            height: 0;
            border-style: solid;
        }

        .arrow-left {
            border-width: 5px 8px 5px 0;
            border-color: transparent #1976d2 transparent transparent;
            left: -8px;
            top: -4px;
        }

        .arrow-right {
            border-width: 5px 0 5px 8px;
            border-color: transparent transparent transparent #1976d2;
            right: -8px;
            top: -4px;
        }

        .dimension-horizontal {
            top: -25px;
            left: 50px;
        }

        .dimension-vertical {
            left: -25px;
            top: 30px;
        }

        .input-explanation {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .explanation-item {
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #4caf50;
        }

        .explanation-item h4 {
            color: #333;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .input-example {
            background: #e8f5e8;
            padding: 10px;
            border-radius: 5px;
            margin-top: 8px;
            border-left: 3px solid #4caf50;
        }

        .example-text {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: #2e7d32;
        }

        .measurement-tips {
            background: #fff3e0;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid #ff9800;
        }

        .tips-list {
            list-style-type: none;
            padding-left: 0;
        }

        .tips-list li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            color: #555;
        }

        .tips-list li:before {
            content: "üìè";
            position: absolute;
            left: 5px;
        }

        .user-info-section {
            background: #e8f4fd;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #2196F3;
        }

        .user-info-section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.4em;
        }

        .user-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .config-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .config-section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.4em;
        }

        .config-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .panels-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .panels-section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.4em;
        }

        .panel-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
        }

        .btn-success {
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
        }

        .panel-row {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .panel-title {
            font-weight: 600;
            color: #333;
        }

        .remove-panel {
            background: #dc3545;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .panel-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        input:required {
            border-left: 4px solid #ff6b6b;
        }

        .action-section {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .calculate-btn {
            flex: 2;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px;
            font-size: 18px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            min-width: 200px;
            transition: transform 0.2s;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .quotation-btn {
            flex: 1;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 15px;
            font-size: 18px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            min-width: 200px;
            transition: transform 0.2s;
        }

        .quotation-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }

        .download-section {
            background: #e8f5e8;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #28a745;
            display: none;
        }

        .download-buttons {
            display: flex;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .download-pdf-btn, .download-excel-btn {
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: none;
            text-decoration: none;
            transition: transform 0.2s;
        }

        .download-pdf-btn {
            background: linear-gradient(135deg, #dc3545, #c82333);
        }

        .download-excel-btn {
            background: linear-gradient(135deg, #28a745, #20c997);
        }

        .download-pdf-btn:hover, .download-excel-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .results-section {
            background: white;
            border-radius: 10px;
            display: none;
        }

        .result-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .result-card h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.2em;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .components-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }

        .component-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #28a745;
        }

        .comp-label {
            font-weight: 600;
            color: #555;
            flex: 2;
        }

        .comp-value {
            font-weight: 700;
            color: #333;
            flex: 1;
            text-align: center;
        }

        .comp-unit-price {
            font-weight: 600;
            color: #666;
            flex: 1;
            text-align: center;
            font-size: 0.9em;
        }

        .comp-cost {
            font-weight: 600;
            color: #ee5a24;
            flex: 1;
            text-align: right;
        }

        .highlight {
            border-color: #ff6b6b;
            background: linear-gradient(135deg, #fff5f5, #fff);
        }

        .cost-breakdown {
            padding: 10px 0;
        }

        .cost-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }

        .cost-item.total {
            border-top: 2px solid #ee5a24;
            border-bottom: none;
            font-size: 1.2em;
            margin-top: 10px;
        }

        .cost-label {
            font-size: 1.1em;
            color: #555;
        }

        .cost-amount {
            font-size: 1.2em;
            font-weight: 700;
            color: #ee5a24;
        }

        .cost-item.total .cost-amount {
            font-size: 1.8em;
        }

        .disclaimer {
            text-align: center;
            color: #666;
            font-style: italic;
            margin-top: 15px;
            font-size: 0.9em;
        }

        .system-breakdown {
            background: #e8f4fd;
            border-left: 4px solid #2196F3;
        }

        .system-item {
            padding: 10px;
            margin: 5px 0;
            background: white;
            border-radius: 5px;
            border-left: 3px solid #2196F3;
        }

        .oem-section {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
        }

        .oem-item {
            padding: 15px;
            margin: 10px 0;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
        }

        .oem-name {
            font-weight: 700;
            color: #333;
            margin-bottom: 5px;
        }

        .oem-contact {
            color: #666;
            margin-bottom: 5px;
        }

        .oem-address {
            color: #888;
            font-size: 0.9em;
        }

        .oem-products {
            color: #555;
            font-style: italic;
            margin-top: 5px;
        }

        .notes {
            background: #fff9e6;
            padding: 25px;
            border-top: 3px solid #ffd700;
        }

        .notes h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .notes ul {
            list-style-type: none;
            padding-left: 0;
        }

        .notes li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            color: #555;
        }

        .notes li:before {
            content: "‚Ä¢";
            color: #ee5a24;
            font-weight: bold;
            position: absolute;
            left: 10px;
        }

        .required-field::after {
            content: " *";
            color: #ff6b6b;
        }

        .compartment-note {
            background: #e7f3ff;
            border-left: 4px solid #1890ff;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }

        .compartment-note h4 {
            color: #1890ff;
            margin-bottom: 8px;
        }

        .quotation-section {
            background: #f0f8ff;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px dashed #1890ff;
        }

        .project-details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .info-tooltip {
            position: relative;
            display: inline-block;
            margin-left: 5px;
            cursor: help;
        }

        .info-tooltip .tooltip-text {
            visibility: hidden;
            width: 300px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -150px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 14px;
            font-weight: normal;
        }

        .info-tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        .pricing-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #28a745;
        }

        .pricing-info h4 {
            color: #28a745;
            margin-bottom: 10px;
        }

        .price-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .price-item {
            display: flex;
            justify-content: space-between;
            padding: 8px;
            background: white;
            border-radius: 5px;
            border: 1px solid #e9ecef;
        }

        .page-footer {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 20px;
            margin-top: 20px;
            border-top: 5px solid #ff6b6b;
        }

        .page-footer a {
            color: #ccc;
            margin: 0 15px;
            text-decoration: none;
            transition: color 0.3s;
        }

        .page-footer a:hover {
            color: #ff6b6b;
        }

        .copyright {
            margin-top: 10px;
            font-size: 0.8em;
            color: #aaa;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .site-nav {
                flex-direction: column;
                text-align: center;
            }
            
            .nav-links {
                justify-content: center;
            }
            
            .main-title {
                font-size: 1.8em;
                padding: 20px;
            }
            
            .centered-subtitle {
                font-size: 1.1em;
                padding: 12px 15px;
            }
            
            .calculator {
                padding: 20px;
            }
            
            .dimension-guide {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .panel-visual {
                height: 200px;
            }
            
            .config-grid {
                grid-template-columns: 1fr;
            }
            
            .user-info-grid {
                grid-template-columns: 1fr;
            }
            
            .action-section {
                flex-direction: column;
            }
            
            .panel-inputs {
                grid-template-columns: 1fr;
            }
            
            .components-grid {
                grid-template-columns: 1fr;
            }
            
            .summary-grid {
                grid-template-columns: 1fr;
            }
            
            .project-details-grid {
                grid-template-columns: 1fr;
            }
            
            .price-list {
                grid-template-columns: 1fr;
            }
            
            .download-buttons {
                flex-direction: column;
            }
            
            .monetization-section {
                flex-direction: column;
                text-align: center;
            }
            
            .monetization-buttons {
                justify-content: center;
            }
            
            .page-footer a {
                display: block;
                margin: 5px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Navigation -->
        <nav class="site-nav">
            <a href="index.html" class="nav-brand">
                <span class="brand-icon">üî•</span>
                <span class="brand-text">FireCalc Pro</span>
            </a>
            <div class="nav-links">
                <a href="index.html" class="nav-link active">Calculator</a>
                <a href="tools.html" class="nav-link">Tools</a>
                <a href="blog.html" class="nav-link">Blog</a>
                <a href="privacy.html" class="nav-link">Privacy</a>
                <a href="terms.html" class="nav-link">Terms</a>
                <a href="affiliate.html" class="nav-link">Affiliate</a>
                <a href="https://buymeacoffee.com/s.amjathkhan" target="_blank" class="support-nav-btn">
                    <span>‚òï Support</span>
                </a>
            </div>
        </nav>

        <h1 class="main-title">üî• Fire Suppression System Calculator</h1>
        <div class="centered-subtitle">Calculate approximate cost for panel fire suppression systems</div>
        
        <div class="monetization-section">
            <div class="monetization-text">
                <h3>üíù Support Our Work</h3>
                <p>This free tool helps professionals calculate fire suppression systems. If you find it useful, please consider supporting our work.</p>
            </div>
            <div class="monetization-buttons">
                <a href="https://amzn.to/4oVFIHa" target="_blank" class="support-btn amazon-btn">
                    üî• Buy Safety Products
                </a>
                <a href="https://buymeacoffee.com/s.amjathkhan" target="_blank" class="support-btn coffee-btn">
                    ‚òï Buy Me a Coffee
                </a>
            </div>
        </div>
        
        <div class="ad-container">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-6687860250561653"
                 data-ad-slot="1234567890"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>
        
        <div class="calculator">
            <div class="visual-guide-section">
                <h2>üìê How to Measure Your Panels - Visual Guide</h2>
                <div class="dimension-guide">
                    <div class="panel-diagram">
                        <h3>üìä Panel Dimension Reference</h3>
                        <div class="diagram-container">
                            <div class="panel-visual">
                                <div class="dimension-line horizontal-line" style="top: -20px; left: 50px; width: 150px;"></div>
                                <div class="dimension-arrow arrow-left" style="top: -24px; left: 50px;"></div>
                                <div class="dimension-arrow arrow-right" style="top: -24px; left: 200px;"></div>
                                <div class="dimension-text dimension-horizontal">Panel Length (2.0m)</div>
                                
                                <div class="dimension-line vertical-line" style="left: -20px; top: 30px; height: 120px;"></div>
                                <div class="dimension-arrow arrow-left" style="left: -24px; top: 30px; transform: rotate(90deg);"></div>
                                <div class="dimension-arrow arrow-right" style="left: -24px; top: 150px; transform: rotate(90deg);"></div>
                                <div class="dimension-text dimension-vertical" style="transform: rotate(-90deg);">Panel Height (1.8m)</div>

                                <div class="compartment compartment-1">
                                    <div class="dimension-text" style="top: -20px; left: 10px; font-size: 10px;">Compartment A</div>
                                </div>
                                <div class="compartment compartment-2">
                                    <div class="dimension-text" style="top: -20px; right: 10px; font-size: 10px;">Compartment B</div>
                                </div>
                                <div class="compartment compartment-3">
                                    <div class="dimension-text" style="top: -20px; left: 10px; font-size: 10px;">Largest Compartment</div>
                                    <div class="dimension-line horizontal-line" style="bottom: -15px; left: 10px; width: 80px;"></div>
                                    <div class="dimension-text" style="bottom: -25px; left: 30px; font-size: 9px;">0.8m Length</div>
                                    <div class="dimension-line vertical-line" style="right: -15px; top: 10px; height: 30px;"></div>
                                    <div class="dimension-text" style="right: -35px; top: 20px; font-size: 9px; transform: rotate(-90deg);">0.6m Height</div>
                                </div>
                            </div>
                        </div>
                        <p style="margin-top: 15px; font-size: 0.9em; color: #666;">
                            <strong>Note:</strong> Dashed rectangles represent individual compartments inside the panel
                        </p>
                    </div>

                    <div class="input-explanation">
                        <h3>üìù How to Fill the Form</h3>
                        
                        <div class="explanation-item">
                            <h4>üì¶ Panel Dimensions</h4>
                            <p><strong>Overall external measurements</strong> of the complete panel enclosure.</p>
                            <div class="input-example">
                                <strong>Example:</strong> 
                                <span class="example-text">Length: 2.0m, Height: 1.8m, Width: 0.6m</span>
                            </div>
                        </div>

                        <div class="explanation-item">
                            <h4>üîç Largest Compartment Dimensions</h4>
                            <p><strong>Measure the biggest enclosed space</strong> inside the panel where fire could occur.</p>
                            <div class="input-example">
                                <strong>Example:</strong> 
                                <span class="example-text">Length: 0.8m, Height: 0.6m, Width: 0.5m</span>
                            </div>
                            <p style="margin-top: 8px; font-size: 0.9em; color: #666;">
                                This is used to calculate gas requirements for fire suppression.
                            </p>
                        </div>

                        <div class="measurement-tips">
                            <h4>üí° Measurement Tips</h4>
                            <ul class="tips-list">
                                <li>Use a tape measure for accurate dimensions</li>
                                <li>Measure in meters (1 meter = 100 centimeters)</li>
                                <li>For irregular panels, measure the maximum dimensions</li>
                                <li>Include all enclosed spaces where electrical components are located</li>
                                <li>If unsure, measure the entire panel as one compartment</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="user-info-section">
                <h2>üë§ User Information (Mandatory)</h2>
                <div class="user-info-grid">
                    <div class="input-group">
                        <label for="userName" class="required-field">Full Name:</label>
                        <input type="text" id="userName" required placeholder="Enter your full name">
                    </div>
                    
                    <div class="input-group">
                        <label for="userOccupation" class="required-field">Occupation:</label>
                        <input type="text" id="userOccupation" required placeholder="e.g., Fire Safety Engineer">
                    </div>
                    
                    <div class="input-group">
                        <label for="userCompany" class="required-field">Company Name:</label>
                        <input type="text" id="userCompany" required placeholder="Enter company name">
                    </div>
                    
                    <div class="input-group">
                        <label for="userContact" class="required-field">Contact Number:</label>
                        <input type="tel" id="userContact" required placeholder="+91-9876543210">
                    </div>
                    
                    <div class="input-group">
                        <label for="userEmail" class="required-field">Email ID:</label>
                        <input type="email" id="userEmail" required placeholder="your.email@company.com">
                    </div>
                </div>
            </div>

            <div class="quotation-section" id="projectDetailsSection">
                <h2>üìã Project Details (For Quotation)</h2>
                <div class="project-details-grid">
                    <div class="input-group">
                        <label for="projectName">Project Name:</label>
                        <input type="text" id="projectName" placeholder="e.g., Mumbai Office Project">
                    </div>
                    
                    <div class="input-group">
                        <label for="clientName">Client Name:</label>
                        <input type="text" id="clientName" placeholder="Client company name">
                    </div>
                    
                    <div class="input-group">
                        <label for="projectLocation">Project Location:</label>
                        <input type="text" id="projectLocation" placeholder="City, Country">
                    </div>
                    
                    <div class="input-group">
                        <label for="quotationNumber">Quotation Number:</label>
                        <input type="text" id="quotationNumber" placeholder="QTN-2024-001">
                    </div>
                </div>
            </div>

            <div class="config-section">
                <h2>‚öôÔ∏è Configuration</h2>
                
                <div class="config-grid">
                    <div class="input-group">
                        <label for="country">Country:</label>
                        <select id="country" onchange="updatePricing()">
                            <option value="india">India</option>
                            <option value="usa">United States</option>
                            <option value="uae">UAE</option>
                            <option value="uk">United Kingdom</option>
                            <option value="germany">Germany</option>
                            <option value="singapore">Singapore</option>
                            <option value="australia">Australia</option>
                            <option value="canada">Canada</option>
                            <option value="saudi">Saudi Arabia</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label for="language">Preferred Language:</label>
                        <select id="language">
                            <option value="english">English</option>
                            <option value="hindi">Hindi</option>
                            <option value="arabic">Arabic</option>
                            <option value="german">German</option>
                            <option value="french">French</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label for="gasType">Gas Type:</label>
                        <select id="gasType">
                            <option value="FK-5-1-12">FK-5-1-12</option>
                            <option value="HFC-236">HFC-236 / FM-200</option>
                            <option value="NOVEC-1230">NOVEC-1230</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label for="brand">Brand:</label>
                        <select id="brand">
                            <option value="kanex">Kanex</option>
                            <option value="firetrace">Firetrace</option>
                            <option value="rotarex">Rotarex</option>
                        </select>
                    </div>
                </div>

                <div class="pricing-info">
                    <h4>üí∞ Current Pricing (India Base Rates)</h4>
                    <div class="price-list">
                        <div class="price-item">
                            <span>1kg Cylinder:</span> <span id="display1kgPrice">‚Çπ18,900</span>
                        </div>
                        <div class="price-item">
                            <span>2kg Cylinder:</span> <span id="display2kgPrice">‚Çπ22,500</span>
                        </div>
                        <div class="price-item">
                            <span>4kg Cylinder:</span> <span id="display4kgPrice">‚Çπ26,500</span>
                        </div>
                        <div class="price-item">
                            <span>Detection Tube (per m):</span> <span id="displayTubePrice">‚Çπ750</span>
                        </div>
                        <div class="price-item">
                            <span>End Line Adapter:</span> <span id="displayEndLinePrice">‚Çπ2,900</span>
                        </div>
                        <div class="price-item">
                            <span>Pressure Switch:</span> <span id="displayPSPrice">‚Çπ5,200</span>
                        </div>
                        <div class="price-item">
                            <span>MCU:</span> <span id="displayMCUPrice">‚Çπ5,200</span>
                        </div>
                        <div class="price-item">
                            <span>Installation (per system):</span> <span id="displayInstPrice">‚Çπ7,500</span>
                        </div>
                    </div>
                    <p style="margin-top: 10px; font-size: 0.85em; color: #666;" id="pricingNote">*GST and freight charges extra</p>
                </div>
            </div>

            <div class="panels-section">
                <h2>üíª Panels & Compartment Dimensions</h2>
                
                <div class="panel-controls">
                    <button class="btn-secondary" onclick="addPanel()">‚ûï Add New Panel</button>
                    <button class="btn-success" onclick="loadSampleProject()">üìã Load Sample Project</button>
                </div>
                
                <div id="panelsContainer">
                    <!-- Panels will be added here -->
                </div>
                
                <div class="compartment-note">
                    <h4>‚ÑπÔ∏è Important Note on Compartments</h4>
                    <p>The system calculates the required fire suppression gas based on the <strong>Largest Compartment Volume</strong> within the panel. The overall panel dimensions are used for detection tube length estimation.</p>
                </div>
            </div>

            <div class="action-section">
                <button class="calculate-btn" onclick="calculateTotalCost()">‚úÖ Calculate Total Cost</button>
                <button class="quotation-btn" onclick="generateQuotation()">üìÑ Generate Quotation</button>
            </div>

            <div class="download-section" id="downloadSection">
                <h3>üíæ Download Options</h3>
                <p>Your quotation is ready for download in the selected formats.</p>
                <div class="download-buttons">
                    <button onclick="downloadQuotationPDF()" class="download-pdf-btn" id="downloadPdfBtn"> üìÑ Download PDF </button>
                    <button onclick="downloadQuotationExcel()" class="download-excel-btn" id="downloadExcelBtn"> üìä Download Excel </button>
                </div>
            </div>

            <div class="results-section" id="results">
                <h2>üìä Calculation Results</h2>
                
                <div class="result-card summary-card">
                    <h3>üìã Project Summary</h3>
                    <div class="summary-grid">
                        <div class="summary-item">
                            <span class="label">Total Panels:</span> <span class="value" id="totalPanels">0</span>
                        </div>
                        <div class="summary-item">
                            <span class="label">Total Volume:</span> <span class="value" id="totalVolume">0 m¬≥</span>
                        </div>
                        <div class="summary-item">
                            <span class="label">Gas Type:</span> <span class="value" id="summaryGasType">FK-5-1-12</span>
                        </div>
                        <div class="summary-item">
                            <span class="label">Total Gas Required:</span> <span class="value" id="totalGas">0 kg</span>
                        </div>
                        <div class="summary-item">
                            <span class="label">Total Systems:</span> <span class="value" id="totalSystems">0</span>
                        </div>
                        <div class="summary-item">
                            <span class="label">Detection Tube:</span> <span class="value" id="summaryTube">0 meters</span>
                        </div>
                    </div>
                </div>

                <div class="result-card system-breakdown" id="systemBreakdown">
                    <h3>üîß System Breakdown</h3>
                    <div id="systemsList">
                        <!-- Systems will be listed here -->
                    </div>
                </div>

                <div class="result-card">
                    <h3>üì¶ Components Required</h3>
                    <div class="components-grid">
                        <div class="component-item">
                            <span class="comp-label">1kg Cylinders:</span> 
                            <span class="comp-value" id="cyl1kg">0</span>
                            <span class="comp-unit-price" id="cyl1kgUnitPrice">‚Çπ0</span>
                            <span class="comp-cost" id="cyl1kgCost">‚Çπ0</span>
                        </div>
                        <div class="component-item">
                            <span class="comp-label">2kg Cylinders:</span> 
                            <span class="comp-value" id="cyl2kg">0</span>
                            <span class="comp-unit-price" id="cyl2kgUnitPrice">‚Çπ0</span>
                            <span class="comp-cost" id="cyl2kgCost">‚Çπ0</span>
                        </div>
                        <div class="component-item">
                            <span class="comp-label">4kg Cylinders:</span> 
                            <span class="comp-value" id="cyl4kg">0</span>
                            <span class="comp-unit-price" id="cyl4kgUnitPrice">‚Çπ0</span>
                            <span class="comp-cost" id="cyl4kgCost">‚Çπ0</span>
                        </div>
                        <div class="component-item">
                            <span class="comp-label">Detection Tube:</span> 
                            <span class="comp-value" id="detectionTube">0 meters</span>
                            <span class="comp-unit-price" id="detectionTubeUnitPrice">‚Çπ0/m</span>
                            <span class="comp-cost" id="detectionTubeCost">‚Çπ0</span>
                        </div>
                        <div class="component-item highlight">
                            <span class="comp-label">T-Connectors:</span> 
                            <span class="comp-value" id="tConnectors">0</span>
                            <span class="comp-unit-price" id="tConnectorsUnitPrice">‚Çπ0</span>
                            <span class="comp-cost" id="tConnectorsCost">‚Çπ0</span>
                        </div>
                        <div class="component-item highlight">
                            <span class="comp-label">End Plugs:</span> 
                            <span class="comp-value" id="endPlugs">0</span>
                            <span class="comp-unit-price" id="endPlugsUnitPrice">‚Çπ0</span>
                            <span class="comp-cost" id="endPlugsCost">‚Çπ0</span>
                        </div>
                        <div class="component-item">
                            <span class="comp-label">End Line Adapters:</span> 
                            <span class="comp-value" id="endLineAdapters">0</span>
                            <span class="comp-unit-price" id="endLineAdaptersUnitPrice">‚Çπ0</span>
                            <span class="comp-cost" id="endLineAdaptersCost">‚Çπ0</span>
                        </div>
                        <div class="component-item">
                            <span class="comp-label">Pressure Switches:</span> 
                            <span class="comp-value" id="pressureSwitches">0</span>
                            <span class="comp-unit-price" id="pressureSwitchesUnitPrice">‚Çπ0</span>
                            <span class="comp-cost" id="pressureSwitchesCost">‚Çπ0</span>
                        </div>
                        <div class="component-item">
                            <span class="comp-label">Master Control Units:</span> 
                            <span class="comp-value" id="mcuUnits">0</span>
                            <span class="comp-unit-price" id="mcuUnitsUnitPrice">‚Çπ0</span>
                            <span class="comp-cost" id="mcuUnitsCost">‚Çπ0</span>
                        </div>
                    </div>
                </div>

                <div class="result-card">
                    <h3>üí≤ Total Cost Estimation</h3>
                    <div class="cost-breakdown">
                        <div class="cost-item">
                            <span class="cost-label">Equipment Cost (Cylinders, Tube, Accessories)</span>
                            <span class="cost-amount" id="equipmentCost">‚Çπ0</span>
                        </div>
                        <div class="cost-item">
                            <span class="cost-label">Installation & Commissioning Cost (per system)</span>
                            <span class="cost-amount" id="installationCost">‚Çπ0</span>
                        </div>
                        <div class="cost-item total">
                            <span class="cost-label">TOTAL ESTIMATED COST</span>
                            <span class="cost-amount" id="totalCost">‚Çπ0</span>
                        </div>
                    </div>
                    <p class="disclaimer">
                        Note: This is an approximation. Final cost may vary based on site conditions, OEM, and chosen accessories.
                    </p>
                </div>

                <div class="result-card oem-section" id="oemSection">
                    <h3>üè≠ Recommended OEM Suppliers</h3>
                    <div id="oemList">
                        <!-- OEMs will be listed here -->
                    </div>
                </div>
            </div>

            <div class="notes">
                <h3>Technical Notes & Assumptions</h3>
                <ul>
                    <li>Calculation based on NFPA 2001:2022 standards</li>
                    <li>Includes 50% additional safety capacity</li>
                    <li>Fire detection tube quantity may vary as per actual site installation</li>
                    <li>Extra detection tube will be on chargeable basis</li>
                    <li>GST and freight charges extra</li>
                    <li>2 core x 1.5 cable included (1.5 meters per system)</li>
                    <li><strong>Fire Detection Tube Rules:</strong></li>
                    <li>- Below 18 meters: No T-connectors or End plugs required</li>
                    <li>- Above 18 meters: 1 T-connector + 1 End plug per 15 meters</li>
                    <li><strong>Compartment Dimensions:</strong> Enter the largest individual compartment size within each panel</li>
                    <li><strong>International Pricing:</strong> 50% additional cost for countries outside India</li>
                </ul>
            </div>
        </div>
    </div>
    
    <div class="page-footer">
        <div>
            <a href="privacy.html">Privacy Policy</a> |
            <a href="terms.html">Terms of Service</a> |
            <a href="affiliate.html">Affiliate Disclosure</a> |
            <a href="tools.html">Tools</a> |
            <a href="blog.html">Blog</a>
        </div>
        <div class="copyright">
            &copy; 2024 FireCalc Pro by WebTools Daily. All rights reserved.
        </div>
    </div>

    <script>
        // Exact pricing from your BOQ
        const basePricesIndia = {
            cylinder1kg: 18900,
            cylinder2kg: 22500,
            cylinder4kg: 26500,
            detectionTube: 750,
            tConnector: 2100,
            endPlug: 1100,
            endLineAdapter: 2900,
            pressureSwitch: 5200,
            mcu: 5200,
            installation: 7500
        };

        // Currency symbols and multipliers for different countries
        const countryData = {
            'india': { symbol: '‚Çπ', multiplier: 1.0, currency: 'INR' },
            'usa': { symbol: '$', multiplier: 1.5, currency: 'USD' },
            'uae': { symbol: 'AED ', multiplier: 1.5, currency: 'AED' },
            'uk': { symbol: '¬£', multiplier: 1.5, currency: 'GBP' },
            'germany': { symbol: '‚Ç¨', multiplier: 1.5, currency: 'EUR' },
            'singapore': { symbol: 'S$', multiplier: 1.5, currency: 'SGD' },
            'australia': { symbol: 'A$', multiplier: 1.5, currency: 'AUD' },
            'canada': { symbol: 'C$', multiplier: 1.5, currency: 'CAD' },
            'saudi': { symbol: 'SAR ', multiplier: 1.5, currency: 'SAR' }
        };

        // Complete OEM Database by Country
        const oemDatabase = {
            'india': [
                { name: 'Kanex Fire Systems', contact: '+91-9876543210', address: 'Mumbai, India', products: 'All gas types', languages: 'Hindi, English' },
                { name: 'Firetrace India', contact: '+91-8765432109', address: 'Delhi, India', products: 'FM-200, FK-5-1-12', languages: 'Hindi, English' },
                { name: 'Rotarex Systems', contact: '+91-7654321098', address: 'Chennai, India', products: 'NOVEC-1230, FK-5-1-12', languages: 'Tamil, English' }
            ],
            'usa': [
                { name: 'Fike Corporation', contact: '+1-816-123-4567', address: 'Missouri, USA', products: 'All gas types', languages: 'English' },
                { name: 'Kidde-Fenwal', contact: '+1-508-123-4567', address: 'Massachusetts, USA', products: 'All gas types', languages: 'English' }
            ],
            'uae': [
                { name: 'NAFFCO', contact: '+971-4-1234567', address: 'Dubai, UAE', products: 'All gas types', languages: 'Arabic, English' }
            ],
            'uk': [
                { name: 'Firetrace UK', contact: '+44-12-12345678', address: 'Birmingham, UK', products: 'All gas types', languages: 'English' },
                { name: 'Kidde Fire Systems', contact: '+44-20-12345678', address: 'London, UK', products: 'All gas types', languages: 'English' }
            ],
            'germany': [
                { name: 'Minimax Fire Protection', contact: '+49-40-123456', address: 'Hamburg, Germany', products: 'All gas types', languages: 'German, English' }
            ],
            'singapore': [
                { name: 'Singapore Fire Safety', contact: '+65-61234567', address: 'Singapore', products: 'All gas types', languages: 'English, Chinese' }
            ],
            'australia': [
                { name: 'Wormald Fire Systems', contact: '+61-2-12345678', address: 'Sydney, Australia', products: 'All gas types', languages: 'English' }
            ],
            'canada': [
                { name: 'Siemens Fire Safety', contact: '+1-800-555-6789', address: 'Toronto, Canada', products: 'All gas types', languages: 'English, French' }
            ],
            'saudi': [
                { name: 'Saudi Fire Protection Co.', contact: '+966-11-1234567', address: 'Riyadh, Saudi Arabia', products: 'All gas types', languages: 'Arabic, English' }
            ]
        };

        // Gas properties from your Excel design sheet
        const gasProperties = {
            'FK-5-1-12': { designConc: 4.5, specificVolume: 0.07 },
            'HFC-236': { designConc: 7.0, specificVolume: 0.14 },
            'NOVEC-1230': { designConc: 4.2, specificVolume: 0.07 }
        };

        let currentCountry = 'india';
        let currentCurrency = countryData['india'];
        let calculationResults = null;

        // Update pricing based on country selection
        function updatePricing() {
            currentCountry = document.getElementById('country').value;
            currentCurrency = countryData[currentCountry];
            showOEMSuppliers(currentCountry);
            updateUnitPriceDisplay();
        }

        // Show OEM suppliers for selected country
        function showOEMSuppliers(country) {
            const oemSection = document.getElementById('oemSection');
            const oemList = document.getElementById('oemList');
            
            if (oemDatabase[country]) {
                oemList.innerHTML = '';
                oemDatabase[country].forEach(oem => {
                    const oemHTML = `
                        <div class="oem-item">
                            <div class="oem-name">${oem.name}</div>
                            <div class="oem-contact">üìû ${oem.contact}</div>
                            <div class="oem-address">üìç ${oem.address}</div>
                            <div class="oem-products">Products: ${oem.products} | Languages: ${oem.languages}</div>
                        </div>
                    `;
                    oemList.innerHTML += oemHTML;
                });
                oemSection.style.display = 'block';
            } else {
                oemSection.style.display = 'none';
            }
        }

        // Update the displayed unit prices in the configuration section
        function updateUnitPriceDisplay() {
            const multiplier = currentCurrency.multiplier;
            const symbol = currentCurrency.symbol;

            document.getElementById('display1kgPrice').textContent = formatCurrency(basePricesIndia.cylinder1kg * multiplier);
            document.getElementById('display2kgPrice').textContent = formatCurrency(basePricesIndia.cylinder2kg * multiplier);
            document.getElementById('display4kgPrice').textContent = formatCurrency(basePricesIndia.cylinder4kg * multiplier);
            document.getElementById('displayTubePrice').textContent = formatCurrency(basePricesIndia.detectionTube * multiplier) + '/m';
            document.getElementById('displayEndLinePrice').textContent = formatCurrency(basePricesIndia.endLineAdapter * multiplier);
            document.getElementById('displayPSPrice').textContent = formatCurrency(basePricesIndia.pressureSwitch * multiplier);
            document.getElementById('displayMCUPrice').textContent = formatCurrency(basePricesIndia.mcu * multiplier);
            document.getElementById('displayInstPrice').textContent = formatCurrency(basePricesIndia.installation * multiplier) + '/System';
        }

        // Format number to currency string
        function formatCurrency(number, rawNumber = false) {
            let num = Math.round(number);
            
            if (rawNumber) return num.toString();
            
            const symbol = currentCurrency.symbol;
            return symbol + num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        // Validate user input
        function validateUserInfo() {
            const userName = document.getElementById('userName').value;
            const userOccupation = document.getElementById('userOccupation').value;
            const userCompany = document.getElementById('userCompany').value;
            const userContact = document.getElementById('userContact').value;
            const userEmail = document.getElementById('userEmail').value;

            if (!userName || !userOccupation || !userCompany || !userContact || !userEmail) {
                alert('Please fill all mandatory user information fields.');
                return false;
            }

            // Basic email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(userEmail)) {
                alert('Please enter a valid email address.');
                return false;
            }
            return true;
        }

        // Initialize the first panel
        function initializeFirstPanel() {
            const panelsContainer = document.getElementById('panelsContainer');
            panelsContainer.innerHTML = '';
            addPanel();
        }

        // Add a new panel
        function addPanel() {
            const panelsContainer = document.getElementById('panelsContainer');
            const panelCount = panelsContainer.children.length + 1;
            const panelHTML = `
                <div class="panel-row" id="panel-${panelCount}">
                    <div class="panel-header">
                        <span class="panel-title">Panel ${panelCount}</span>
                        ${panelCount > 1 ? '<button class="remove-panel" onclick="removePanel(' + panelCount + ')">Remove</button>' : ''}
                    </div>
                    <div class="panel-inputs">
                        <div class="input-group">
                            <label for="panelName-${panelCount}">Panel Name/ID:</label>
                            <input type="text" id="panelName-${panelCount}" placeholder="e.g., Main Control Panel">
                        </div>
                        <div class="input-group">
                            <label for="panelLength-${panelCount}">Panel Length (m):</label>
                            <input type="number" id="panelLength-${panelCount}" step="0.1" value="0" placeholder="Overall panel length" min="0">
                        </div>
                        <div class="input-group">
                            <label for="panelHeight-${panelCount}">Panel Height (m):</label>
                            <input type="number" id="panelHeight-${panelCount}" step="0.1" value="0" placeholder="Overall panel height" min="0">
                        </div>
                        <div class="input-group">
                            <label for="panelWidth-${panelCount}">Panel Width (m):</label>
                            <input type="number" id="panelWidth-${panelCount}" step="0.1" value="0" placeholder="Overall panel width" min="0">
                        </div>
                        <div class="input-group">
                            <label for="compLength-${panelCount}">
                                Largest Compartment Length (m):
                                <span class="info-tooltip">
                                    ‚ÑπÔ∏è
                                    <span class="tooltip-text">Dimension of the largest individual enclosed space within the panel where fire could occur</span>
                                </span>
                            </label>
                            <input type="number" id="compLength-${panelCount}" step="0.1" value="0" placeholder="Compartment length" min="0">
                        </div>
                        <div class="input-group">
                            <label for="compHeight-${panelCount}">Largest Compartment Height (m):</label>
                            <input type="number" id="compHeight-${panelCount}" step="0.1" value="0" placeholder="Compartment height" min="0">
                        </div>
                        <div class="input-group">
                            <label for="compWidth-${panelCount}">Largest Compartment Width (m):</label>
                            <input type="number" id="compWidth-${panelCount}" step="0.1" value="0" placeholder="Compartment width" min="0">
                        </div>
                        <div class="input-group">
                            <label for="quantity-${panelCount}">Quantity of this Panel:</label>
                            <input type="number" id="quantity-${panelCount}" step="1" min="1" value="1" placeholder="Number of identical panels">
                        </div>
                    </div>
                </div>
            `;
            panelsContainer.innerHTML += panelHTML;
        }

        // Load sample project data
        function loadSampleProject() {
            initializeFirstPanel();
            
            // Sample data based on a common project scenario
            const samplePanels = [
                { name: "Main Control Panel", panelLength: 4.3, panelHeight: 2, panelWidth: 1.1, compLength: 0.8, compHeight: 2, compWidth: 1.1, quantity: 1 },
                { name: "UPS Panel", panelLength: 1.2, panelHeight: 1.9, panelWidth: 0.7, compLength: 0.8, compHeight: 1.9, compWidth: 0.7, quantity: 1 },
                { name: "Server Rack Panel", panelLength: 2.7, panelHeight: 1.9, panelWidth: 0.8, compLength: 0.8, compHeight: 1.9, compWidth: 0.8, quantity: 1 },
                { name: "Distribution Panel", panelLength: 5.9, panelHeight: 2.1, panelWidth: 0.7, compLength: 0.8, compHeight: 2.1, compWidth: 0.7, quantity: 1 }
            ];

            samplePanels.forEach((panel, index) => {
                if (index > 0) addPanel();
                const panelId = index + 1;
                document.getElementById(`panelName-${panelId}`).value = panel.name;
                document.getElementById(`panelLength-${panelId}`).value = panel.panelLength;
                document.getElementById(`panelHeight-${panelId}`).value = panel.panelHeight;
                document.getElementById(`panelWidth-${panelId}`).value = panel.panelWidth;
                document.getElementById(`compLength-${panelId}`).value = panel.compLength;
                document.getElementById(`compHeight-${panelId}`).value = panel.compHeight;
                document.getElementById(`compWidth-${panelId}`).value = panel.compWidth;
                document.getElementById(`quantity-${panelId}`).value = panel.quantity;
            });
            
            alert('Sample project loaded! Please review the details and click "Calculate Total Cost" to see the results.');
        }

        // Remove a panel
        function removePanel(panelId) {
            const panel = document.getElementById(`panel-${panelId}`);
            if (panel) {
                panel.remove();
                
                // Renumber remaining panels
                const panels = document.querySelectorAll('.panel-row');
                panels.forEach((panel, index) => {
                    const newId = index + 1;
                    panel.id = `panel-${newId}`;
                    panel.querySelector('.panel-title').textContent = `Panel ${newId}`;
                    const removeButton = panel.querySelector('.remove-panel');
                    if (removeButton) {
                        removeButton.setAttribute('onclick', `removePanel(${newId})`);
                        // Hide remove button for the first panel
                        if (newId === 1) removeButton.remove(); 
                    }
                });

                // If only one panel remains, ensure its remove button is hidden
                if (panels.length === 1) {
                    const removeButton = panels[0].querySelector('.remove-panel');
                    if (removeButton) removeButton.remove();
                }

                alert(`Panel ${panelId} removed.`);
            }
        }

        // Calculate gas cylinder requirements
        function calculateCylinders(totalActualGas) {
            let requiredGas = Math.ceil(totalActualGas);
            let cyl4kg = 0;
            let cyl2kg = 0;
            let cyl1kg = 0;
            let totalCylinders = 0;

            if (totalActualGas <= 0) {
                return { cyl1kg: 0, cyl2kg: 0, cyl4kg: 0, totalCylinders: 0 };
            }

            // Allocation logic based on template
            if (totalActualGas > 0 && totalActualGas <= 1.0) {
                cyl1kg = 1;
            } else if (totalActualGas > 1.0 && totalActualGas <= 2.0) {
                cyl2kg = 1;
            } else if (totalActualGas > 2.0 && totalActualGas <= 4.0) {
                cyl4kg = 1;
            } else if (totalActualGas > 4.0) {
                requiredGas = Math.ceil(totalActualGas);
                cyl4kg = Math.floor(requiredGas / 4);
                requiredGas = requiredGas % 4;

                if (requiredGas === 3) {
                    cyl2kg++;
                    cyl1kg++;
                } else if (requiredGas === 2) {
                    cyl2kg++;
                } else if (requiredGas === 1) {
                    cyl1kg++;
                }
            }

            totalCylinders = cyl4kg + cyl2kg + cyl1kg;
            
            return {
                cyl1kg: cyl1kg,
                cyl2kg: cyl2kg,
                cyl4kg: cyl4kg,
                totalCylinders: totalCylinders
            };
        }

        // Calculate detection tube components based on total tube length
        function calculateTubeComponents(totalTubeLength) {
            let tConnectors = 0;
            let endPlugs = 0;
            const detectionTubeLength = totalTubeLength;

            if (detectionTubeLength > 18) {
                tConnectors = Math.floor(detectionTubeLength / 15);
                endPlugs = tConnectors;
            }

            return {
                tConnectors: tConnectors,
                endPlugs: endPlugs,
                effectiveTubeLength: detectionTubeLength
            };
        }

        // Calculate everything based on Excel formulas
        function calculateTotalCost() {
            if (!validateUserInfo()) {
                return;
            }

            const panels = document.querySelectorAll('.panel-row');
            let totalVolume = 0;
            let totalGasRequired = 0;
            let totalActualGas = 0;
            let totalPanels = 0;
            let totalDetectionTube = 0;

            const gasType = document.getElementById('gasType').value;
            const gasProps = gasProperties[gasType];
            
            // Recalculate based on input data
            panels.forEach((panel, index) => {
                const panelId = index + 1;
                const compLength = parseFloat(document.getElementById(`compLength-${panelId}`).value) || 0;
                const compHeight = parseFloat(document.getElementById(`compHeight-${panelId}`).value) || 0;
                const compWidth = parseFloat(document.getElementById(`compWidth-${panelId}`).value) || 0;
                const panelLength = parseFloat(document.getElementById(`panelLength-${panelId}`).value) || 0;
                const panelHeight = parseFloat(document.getElementById(`panelHeight-${panelId}`).value) || 0;
                const panelWidth = parseFloat(document.getElementById(`panelWidth-${panelId}`).value) || 0;
                const quantity = parseInt(document.getElementById(`quantity-${panelId}`).value) || 1;
                
                if (compLength > 0 && compHeight > 0 && compWidth > 0) {
                    // Compartment Volume = Length * Height * Width
                    const compVolume = compLength * compHeight * compWidth;

                    // Min Gas Required = (Volume/S) * (Design Conc / (100 - Design Conc))
                    const minGasRequired = (compVolume / gasProps.specificVolume) * (gasProps.designConc / (100 - gasProps.designConc));

                    // Actual Gas with 50% safety = Min Gas * 1.5
                    const actualGas = minGasRequired * 1.5;

                    // Detection Tube calculation 
                    // Using panel perimeter for tube estimation
                    const detectionTube = Math.max(12, Math.ceil((panelLength + panelHeight + panelWidth) * 2));

                    totalVolume += compVolume * quantity;
                    totalGasRequired += minGasRequired * quantity;
                    totalActualGas += actualGas * quantity;
                    totalDetectionTube += detectionTube * quantity;
                    totalPanels += quantity;
                }
            });

            // Calculate required systems and components based on revised logic
            const cylinders = calculateCylinders(totalActualGas);
            const tubeComponents = calculateTubeComponents(totalDetectionTube);

            const endLineAdapters = cylinders.totalCylinders;
            const pressureSwitches = cylinders.totalCylinders;
            const mcuUnits = cylinders.totalCylinders;

            // Cost Calculation
            const countryMultiplier = currentCurrency.multiplier;

            let equipmentCost = 0;
            equipmentCost += cylinders.cyl1kg * basePricesIndia.cylinder1kg * countryMultiplier;
            equipmentCost += cylinders.cyl2kg * basePricesIndia.cylinder2kg * countryMultiplier;
            equipmentCost += cylinders.cyl4kg * basePricesIndia.cylinder4kg * countryMultiplier;
            equipmentCost += totalDetectionTube * basePricesIndia.detectionTube * countryMultiplier;
            equipmentCost += tubeComponents.tConnectors * basePricesIndia.tConnector * countryMultiplier;
            equipmentCost += tubeComponents.endPlugs * basePricesIndia.endPlug * countryMultiplier;
            equipmentCost += endLineAdapters * basePricesIndia.endLineAdapter * countryMultiplier;
            equipmentCost += pressureSwitches * basePricesIndia.pressureSwitch * countryMultiplier;
            equipmentCost += mcuUnits * basePricesIndia.mcu * countryMultiplier;

            const installationCost = basePricesIndia.installation * cylinders.totalCylinders * countryMultiplier;
            const totalCost = equipmentCost + installationCost;

            // Store calculation results for quotation
            calculationResults = {
                totalVolume,
                totalGasRequired,
                totalActualGas,
                totalPanels,
                totalDetectionTube,
                cylinders,
                tubeComponents,
                endLineAdapters,
                pressureSwitches,
                mcuUnits,
                equipmentCost,
                installationCost,
                totalCost,
                gasType
            };

            // Update unit prices first
            updateUnitPriceDisplay();

            // Display results
            document.getElementById('totalPanels').textContent = totalPanels;
            document.getElementById('totalVolume').textContent = totalVolume.toFixed(2) + ' m¬≥';
            document.getElementById('summaryGasType').textContent = gasType;
            document.getElementById('totalGas').textContent = totalActualGas.toFixed(2) + ' kg';
            document.getElementById('totalSystems').textContent = cylinders.totalCylinders;
            document.getElementById('summaryTube').textContent = totalDetectionTube + ' meters';

            // Update pricing note
            document.getElementById('pricingNote').textContent = currentCountry === 'india' ? '*GST and freight charges extra' : `*Prices include 50% additional cost for ${currentCountry.toUpperCase()}. Local taxes and freight extra.`;

            // Display component quantities
            document.getElementById('cyl1kg').textContent = cylinders.cyl1kg;
            document.getElementById('cyl2kg').textContent = cylinders.cyl2kg;
            document.getElementById('cyl4kg').textContent = cylinders.cyl4kg;
            document.getElementById('detectionTube').textContent = totalDetectionTube + ' meters';
            document.getElementById('tConnectors').textContent = tubeComponents.tConnectors + (tubeComponents.tConnectors === 0 ? ' (not required)' : '');
            document.getElementById('endPlugs').textContent = tubeComponents.endPlugs + (tubeComponents.endPlugs === 0 ? ' (not required)' : '');
            document.getElementById('endLineAdapters').textContent = endLineAdapters;
            document.getElementById('pressureSwitches').textContent = pressureSwitches;
            document.getElementById('mcuUnits').textContent = mcuUnits;
            
            // Display costs
            document.getElementById('cyl1kgCost').textContent = formatCurrency(cylinders.cyl1kg * basePricesIndia.cylinder1kg * countryMultiplier);
            document.getElementById('cyl2kgCost').textContent = formatCurrency(cylinders.cyl2kg * basePricesIndia.cylinder2kg * countryMultiplier);
            document.getElementById('cyl4kgCost').textContent = formatCurrency(cylinders.cyl4kg * basePricesIndia.cylinder4kg * countryMultiplier);
            document.getElementById('detectionTubeCost').textContent = formatCurrency(totalDetectionTube * basePricesIndia.detectionTube * countryMultiplier);
            document.getElementById('tConnectorsCost').textContent = formatCurrency(tubeComponents.tConnectors * basePricesIndia.tConnector * countryMultiplier);
            document.getElementById('endPlugsCost').textContent = formatCurrency(tubeComponents.endPlugs * basePricesIndia.endPlug * countryMultiplier);
            document.getElementById('endLineAdaptersCost').textContent = formatCurrency(endLineAdapters * basePricesIndia.endLineAdapter * countryMultiplier);
            document.getElementById('pressureSwitchesCost').textContent = formatCurrency(pressureSwitches * basePricesIndia.pressureSwitch * countryMultiplier);
            document.getElementById('mcuUnitsCost').textContent = formatCurrency(mcuUnits * basePricesIndia.mcu * countryMultiplier);

            // Display unit prices for component cards
            document.getElementById('cyl1kgUnitPrice').textContent = formatCurrency(basePricesIndia.cylinder1kg * countryMultiplier);
            document.getElementById('cyl2kgUnitPrice').textContent = formatCurrency(basePricesIndia.cylinder2kg * countryMultiplier);
            document.getElementById('cyl4kgUnitPrice').textContent = formatCurrency(basePricesIndia.cylinder4kg * countryMultiplier);
            document.getElementById('detectionTubeUnitPrice').textContent = formatCurrency(basePricesIndia.detectionTube * countryMultiplier) + '/m';
            document.getElementById('tConnectorsUnitPrice').textContent = formatCurrency(basePricesIndia.tConnector * countryMultiplier);
            document.getElementById('endPlugsUnitPrice').textContent = formatCurrency(basePricesIndia.endPlug * countryMultiplier);
            document.getElementById('endLineAdaptersUnitPrice').textContent = formatCurrency(basePricesIndia.endLineAdapter * countryMultiplier);
            document.getElementById('pressureSwitchesUnitPrice').textContent = formatCurrency(basePricesIndia.pressureSwitch * countryMultiplier);
            document.getElementById('mcuUnitsUnitPrice').textContent = formatCurrency(basePricesIndia.mcu * countryMultiplier);
            
            // Display cost breakdown
            document.getElementById('equipmentCost').textContent = formatCurrency(equipmentCost);
            document.getElementById('installationCost').textContent = formatCurrency(installationCost);
            document.getElementById('totalCost').textContent = formatCurrency(totalCost);

            // Show results
            document.getElementById('results').style.display = 'block';
            document.getElementById('systemBreakdown').style.display = 'block';

            // Generate system breakdown list
            const systemsList = document.getElementById('systemsList');
            systemsList.innerHTML = '';
            
            let systemCount = 1;
            for (let i = 0; i < cylinders.cyl4kg; i++) {
                systemsList.innerHTML += `<div class="system-item">System ${systemCount++}: 4kg Cylinder | Accessories (EL Adapter, PS, MCU) | Tube Length: ${Math.round(totalDetectionTube / cylinders.totalCylinders)}m (Avg.)</div>`;
            }
            for (let i = 0; i < cylinders.cyl2kg; i++) {
                systemsList.innerHTML += `<div class="system-item">System ${systemCount++}: 2kg Cylinder | Accessories (EL Adapter, PS, MCU) | Tube Length: ${Math.round(totalDetectionTube / cylinders.totalCylinders)}m (Avg.)</div>`;
            }
            for (let i = 0; i < cylinders.cyl1kg; i++) {
                systemsList.innerHTML += `<div class="system-item">System ${systemCount++}: 1kg Cylinder | Accessories (EL Adapter, PS, MCU) | Tube Length: ${Math.round(totalDetectionTube / cylinders.totalCylinders)}m (Avg.)</div>`;
            }
        }

        // Generate quotation
        function generateQuotation() {
            if (!validateUserInfo()) {
                return;
            }

            if (!calculationResults) {
                alert('Please calculate the total cost first before generating quotation.');
                return;
            }
            
            const userName = document.getElementById('userName').value;
            const userCompany = document.getElementById('userCompany').value;
            const projectName = document.getElementById('projectName').value || 'Fire Suppression System Project';
            const clientName = document.getElementById('clientName').value || 'Valued Client';
            const quotationNumber = document.getElementById('quotationNumber').value || 'QTN-' + new Date().getFullYear() + '-' + Math.floor(1000 + Math.random() * 9000);

            // Show success message with visual feedback
            const quotationBtn = document.querySelector('.quotation-btn');
            const originalText = quotationBtn.textContent;
            const originalBg = quotationBtn.style.background;
            quotationBtn.textContent = '‚úÖ Quotation Generated!';
            quotationBtn.style.background = 'linear-gradient(135deg, #28a745, #20c997)';
            setTimeout(() => {
                quotationBtn.textContent = originalText;
                quotationBtn.style.background = originalBg;
            }, 3000);

            // Show download options
            document.getElementById('downloadSection').style.display = 'block';
            document.getElementById('downloadPdfBtn').style.display = 'inline-block';
            document.getElementById('downloadExcelBtn').style.display = 'inline-block';

            alert(`Quotation ${quotationNumber} generated for ${projectName}!\n\nClient: ${clientName}\nPrepared by: ${userName} (${userCompany})\nTotal Cost: ${document.getElementById('totalCost').textContent}\n\nYou can now download the quotation in PDF (Text) or Excel (CSV) format.`);
        }

        // Download quotation as Text (Simulating PDF)
        function downloadQuotationPDF() {
            if (!validateUserInfo()) {
                return;
            }

            if (!calculationResults) {
                alert('Please calculate the total cost first before downloading quotation.');
                return;
            }
            
            const userName = document.getElementById('userName').value;
            const userOccupation = document.getElementById('userOccupation').value;
            const userCompany = document.getElementById('userCompany').value;
            const userContact = document.getElementById('userContact').value;
            const userEmail = document.getElementById('userEmail').value;
            const projectName = document.getElementById('projectName').value || 'Fire Suppression System Project';
            const clientName = document.getElementById('clientName').value || 'Valued Client';
            const projectLocation = document.getElementById('projectLocation').value || 'Not specified';
            const quotationNumber = document.getElementById('quotationNumber').value || 'QTN-' + new Date().getFullYear() + '-' + Math.floor(1000 + Math.random() * 9000);
            
            const quotationContent = `
 FIRE SUPPRESSION SYSTEM QUOTATION
 ==================================

Quotation Number: ${quotationNumber}
Date: ${new Date().toLocaleDateString()}
Project: ${projectName}
Client: ${clientName}
Location: ${projectLocation}

PREPARED BY:
------------
Name: ${userName}
Occupation: ${userOccupation}
Company: ${userCompany}
Contact: ${userContact}
Email: ${userEmail}

PROJECT SUMMARY:
----------------
Total Panels: ${calculationResults.totalPanels}
Total Volume: ${calculationResults.totalVolume.toFixed(2)} m¬≥
Gas Type: ${calculationResults.gasType}
Total Gas Required: ${calculationResults.totalActualGas.toFixed(2)} kg
Total Systems: ${calculationResults.cylinders.totalCylinders}
Detection Tube: ${calculationResults.totalDetectionTube} meters

COMPONENTS BREAKDOWN: (Prices in ${currentCurrency.currency})
--------------------
1kg Cylinders: ${calculationResults.cylinders.cyl1kg} @ ${formatCurrency(basePricesIndia.cylinder1kg * currentCurrency.multiplier)} each
2kg Cylinders: ${calculationResults.cylinders.cyl2kg} @ ${formatCurrency(basePricesIndia.cylinder2kg * currentCurrency.multiplier)} each
4kg Cylinders: ${calculationResults.cylinders.cyl4kg} @ ${formatCurrency(basePricesIndia.cylinder4kg * currentCurrency.multiplier)} each
Detection Tube: ${calculationResults.totalDetectionTube}m @ ${formatCurrency(basePricesIndia.detectionTube * currentCurrency.multiplier)}/m
T-Connectors: ${calculationResults.tubeComponents.tConnectors} @ ${formatCurrency(basePricesIndia.tConnector * currentCurrency.multiplier)} each
End Plugs: ${calculationResults.tubeComponents.endPlugs} @ ${formatCurrency(basePricesIndia.endPlug * currentCurrency.multiplier)} each
End Line Adapters: ${calculationResults.endLineAdapters} @ ${formatCurrency(basePricesIndia.endLineAdapter * currentCurrency.multiplier)} each
Pressure Switches: ${calculationResults.pressureSwitches} @ ${formatCurrency(basePricesIndia.pressureSwitch * currentCurrency.multiplier)} each
Master Control Units: ${calculationResults.mcuUnits} @ ${formatCurrency(basePricesIndia.mcu * currentCurrency.multiplier)} each

COST BREAKDOWN:
---------------
Equipment Cost: ${formatCurrency(calculationResults.equipmentCost)}
Installation Cost: ${formatCurrency(calculationResults.installationCost)}

TOTAL ESTIMATED COST: ${formatCurrency(calculationResults.totalCost)}

NOTES:
------
1. Calculation based on NFPA 2001:2022 standards
2. Includes 50% additional safety capacity
3. Fire detection tube quantity may vary as per actual site installation
4. Extra detection tube will be on chargeable basis
5. GST and freight charges extra
6. 2 core x 1.5 cable included (1.5 meters per system)

VALIDITY:
---------
This quotation is valid for 30 days from the date of issue.

Thank you for your business!

${userCompany}
${userName}
${userContact}
${userEmail}
`;
            
            // Create and download the text file
            const blob = new Blob([quotationContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Quotation_${quotationNumber}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert(`Text-based Bill of Quantity ${quotationNumber} downloaded successfully!`);
        }

        // Download quotation as Excel (CSV)
        function downloadQuotationExcel() {
            if (!validateUserInfo()) {
                return;
            }

            if (!calculationResults) {
                alert('Please calculate the total cost first before downloading quotation.');
                return;
            }
            
            const userName = document.getElementById('userName').value;
            const userCompany = document.getElementById('userCompany').value;
            const projectName = document.getElementById('projectName').value || 'Fire Suppression System Project';
            const clientName = document.getElementById('clientName').value || 'Valued Client';
            const quotationNumber = document.getElementById('quotationNumber').value || 'QTN-' + new Date().getFullYear() + '-' + Math.floor(1000 + Math.random() * 9000);
            
            const getPureCost = (cost) => {
                return formatCurrency(cost, true);
            };

            const excelContent = `
Quotation Number,${quotationNumber}
Date,${new Date().toLocaleDateString()}
Project,${projectName}
Client,${clientName}
Location,${document.getElementById('projectLocation').value || 'Not specified'}

Prepared By,${userName}
Company,${userCompany}

PROJECT SUMMARY
Total Panels,${calculationResults.totalPanels}
Total Volume,${calculationResults.totalVolume.toFixed(2)} m¬≥
Gas Type,${calculationResults.gasType}
Total Gas Required,${calculationResults.totalActualGas.toFixed(2)} kg
Total Systems,${calculationResults.cylinders.totalCylinders}
Detection Tube,${calculationResults.totalDetectionTube} meters

COMPONENTS BREAKDOWN
Item,Quantity,Unit Price,Total Price
1kg Cylinders,${calculationResults.cylinders.cyl1kg},${getPureCost(basePricesIndia.cylinder1kg * currentCurrency.multiplier)},${getPureCost(calculationResults.cylinders.cyl1kg * basePricesIndia.cylinder1kg * currentCurrency.multiplier)}
2kg Cylinders,${calculationResults.cylinders.cyl2kg},${getPureCost(basePricesIndia.cylinder2kg * currentCurrency.multiplier)},${getPureCost(calculationResults.cylinders.cyl2kg * basePricesIndia.cylinder2kg * currentCurrency.multiplier)}
4kg Cylinders,${calculationResults.cylinders.cyl4kg},${getPureCost(basePricesIndia.cylinder4kg * currentCurrency.multiplier)},${getPureCost(calculationResults.cylinders.cyl4kg * basePricesIndia.cylinder4kg * currentCurrency.multiplier)}
Detection Tube,${calculationResults.totalDetectionTube}m,${getPureCost(basePricesIndia.detectionTube * currentCurrency.multiplier)}/m,${getPureCost(calculationResults.totalDetectionTube * basePricesIndia.detectionTube * currentCurrency.multiplier)}
End Line Adapters,${calculationResults.endLineAdapters},${getPureCost(basePricesIndia.endLineAdapter * currentCurrency.multiplier)},${getPureCost(calculationResults.endLineAdapters * basePricesIndia.endLineAdapter * currentCurrency.multiplier)}
Pressure Switches,${calculationResults.pressureSwitches},${getPureCost(basePricesIndia.pressureSwitch * currentCurrency.multiplier)},${getPureCost(calculationResults.pressureSwitches * basePricesIndia.pressureSwitch * currentCurrency.multiplier)}
T-Connectors,${calculationResults.tubeComponents.tConnectors},${getPureCost(basePricesIndia.tConnector * currentCurrency.multiplier)},${getPureCost(calculationResults.tubeComponents.tConnectors * basePricesIndia.tConnector * currentCurrency.multiplier)}
End Plugs,${calculationResults.tubeComponents.endPlugs},${getPureCost(basePricesIndia.endPlug * currentCurrency.multiplier)},${getPureCost(calculationResults.tubeComponents.endPlugs * basePricesIndia.endPlug * currentCurrency.multiplier)}
Master Control Units,${calculationResults.mcuUnits},${getPureCost(basePricesIndia.mcu * currentCurrency.multiplier)},${getPureCost(calculationResults.mcuUnits * basePricesIndia.mcu * currentCurrency.multiplier)}

COST BREAKDOWN
Equipment Cost,${getPureCost(calculationResults.equipmentCost)}
Installation Cost,${getPureCost(calculationResults.installationCost)}
TOTAL ESTIMATED COST,${getPureCost(calculationResults.totalCost)}
            `;
            
            // Create and download CSV file
            const blob = new Blob([excelContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Quotation_${quotationNumber}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert(`Excel (CSV) Quotation ${quotationNumber} downloaded successfully!`);
        }

        // Initialize when page loads
        window.addEventListener('load', function() {
            initializeFirstPanel();
            showOEMSuppliers('india');
            updateUnitPriceDisplay();
            gtag('event', 'page_view', {
                page_title: 'Fire Suppression System Calculator - WebTools Daily',
                page_location: window.location.href
            });
        });
    </script>
</body>
</html>